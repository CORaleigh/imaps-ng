!function(e,i){angular.module("ngCsv.config",[]).value("ngCsv.config",{debug:!0}).config(["$compileProvider",function(e){angular.isDefined(e.urlSanitizationWhitelist)?e.urlSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/):e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),angular.module("ngCsv.directives",["ngCsv.services"]),angular.module("ngCsv.services",[]),angular.module("ngCsv",["ngCsv.config","ngCsv.services","ngCsv.directives","ngSanitize"]),angular.module("ngCsv.services").service("CSV",["$q",function(e){var i="\r\n",t="\ufeff",a={"\\t":"	","\\b":"\b","\\v":"\x0B","\\f":"\f","\\r":"\r"};this.stringifyField=function(e,i){return"locale"===i.decimalSep&&this.isFloat(e)?e.toLocaleString():"."!==i.decimalSep&&this.isFloat(e)?e.toString().replace(".",i.decimalSep):"string"==typeof e?(e=e.replace(/"/g,'""'),(i.quoteStrings||e.indexOf(",")>-1||e.indexOf("\n")>-1||e.indexOf("\r")>-1)&&(e=i.txtDelim+e+i.txtDelim),"0"===e.charAt(0)&&(e=i.txtDelim+"="+i.txtDelim+i.txtDelim+e+i.txtDelim+i.txtDelim+i.txtDelim),e):"boolean"==typeof e?e?"TRUE":"FALSE":e},this.isFloat=function(e){return+e===e&&(!isFinite(e)||Boolean(e%1))},this.stringify=function(a,n){var r=e.defer(),l=this,o="",s="",d=e.when(a).then(function(e){if(angular.isDefined(n.header)&&n.header){var a,d;a=[],angular.forEach(n.header,function(e,i){this.push(l.stringifyField(e,n))},a),d=a.join(n.fieldSep?n.fieldSep:","),s+=d+i}var c=[];angular.isArray(e)?c=e:angular.isFunction(e)&&(c=e()),angular.forEach(c,function(e,t){var a,r,o=angular.copy(c[t]);r=[],angular.forEach(o,function(e,i){this.push(l.stringifyField(e,n))},r),a=r.join(n.fieldSep?n.fieldSep:","),s+=t<c.length?a+i:a}),n.addByteOrderMarker&&(o+=t),o+=s,r.resolve(o)});return"function"==typeof d["catch"]&&d["catch"](function(e){r.reject(e)}),r.promise},this.isSpecialChar=function(e){return void 0!==a[e]},this.getSpecialChar=function(e){return a[e]}}]),angular.module("ngCsv.directives").directive("ngCsv",["$parse","$q","CSV","$document","$timeout",function(i,t,a,n,r){return{restrict:"AC",scope:{data:"&ngCsv",filename:"@filename",header:"&csvHeader",txtDelim:"@textDelimiter",decimalSep:"@decimalSeparator",quoteStrings:"@quoteStrings",fieldSep:"@fieldSeparator",lazyLoad:"@lazyLoad",addByteOrderMarker:"@addBom",ngClick:"&",charset:"@charset"},controller:["$scope","$element","$attrs","$transclude",function(e,i,n,r){function l(){var i={txtDelim:e.txtDelim?e.txtDelim:'"',decimalSep:e.decimalSep?e.decimalSep:".",quoteStrings:e.quoteStrings,addByteOrderMarker:e.addByteOrderMarker};return angular.isDefined(n.csvHeader)&&(i.header=e.$eval(e.header)),i.fieldSep=e.fieldSep?e.fieldSep:",",i.fieldSep=a.isSpecialChar(i.fieldSep)?a.getSpecialChar(i.fieldSep):i.fieldSep,i}e.csv="",angular.isDefined(e.lazyLoad)&&"true"==e.lazyLoad||angular.isArray(e.data)&&e.$watch("data",function(i){e.buildCSV()},!0),e.getFilename=function(){return e.filename||"download.csv"},e.buildCSV=function(){var r=t.defer();return i.addClass(n.ngCsvLoadingClass||"ng-csv-loading"),a.stringify(e.data(),l()).then(function(t){e.csv=t,i.removeClass(n.ngCsvLoadingClass||"ng-csv-loading"),r.resolve(t)}),e.$apply(),r.promise}}],link:function(i,t,a){function l(){var t=i.charset||"utf-8",a=new Blob([i.csv],{type:"text/csv;charset="+t+";"});if(e.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(a,i.getFilename());else{var l=angular.element("<a></a>");l.attr("href",e.URL.createObjectURL(a)),l.attr("download",i.getFilename()),l.attr("target","_blank"),n.find("body").append(l),r(function(){l[0].click(),l.remove()},null)}}t.bind("click",function(e){i.buildCSV().then(function(e){l()}),i.$apply()})}}}])}(window,document);